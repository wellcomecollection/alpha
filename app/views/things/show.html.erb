<% content_for :title, @thing.title %>

<% content_for :head do %>

  <meta name="twitter:card" content="product">
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="<%= @thing.title %>">
  <meta property="og:title" content="<%= @thing.title %>" />

  <% if @thing.cover_image_url %>
    <meta name="twitter:image" content="<%= @thing.cover_image_url(1800,1800) %>">
    <meta property="og:image" content="<%= @thing.cover_image_url(1800,1800) %>" />
  <% end %>

  <% if @thing.year %>
    <meta name="twitter:label1" content="Year of publication">
    <meta name="twitter:data1" content="<%= @thing.year %>">
  <% end %>

  <% if @thing.people.length == 1 %>
    <meta name="twitter:label2" content="Author">
    <meta name="twitter:data2" content="<%= @thing.people.first.name %>">
  <% elsif @thing.people.length > 1 %>
    <meta name="twitter:label2" content="Authors">
    <meta name="twitter:data2" content="<%= @thing.people.collect(&:name).to_sentence %>">
  <% end %>

  <% if @thing.summary %>
    <meta name="twitter:description" content="<%= truncate(@thing.summary, length: 300, separator: ' ') %>" />
    <meta property="og:description" content="<%= truncate(@thing.summary, length: 300, separator: ' ') %>" />
  <% end %>

  <meta property="og:url" content="<%= thing_url(@thing) %>" />

<% end %>

<% if @thing.people.length > 0 %>
  <div class="row author">
    <div class="twelve columns big">
      <p>
        <%= @thing.people.collect do |person| %>
          <% link_to person.name, person %>
        <% end.to_sentence.html_safe %>
        /
      </p>
    </div>
  </div>
<% end %>

<%= @thing.archives_tree.collect do |record|  %>
  <% link_to record.title, thing_path(record) %>
<% end.join(' / ').html_safe %>

<h1><%= @thing.title %></h1>

<% if @thing.pdf_file %>

  <embed src="<%= @thing.pdf_file %>" width="100%" height="600" pluginspage="http://www.adobe.com/products/acrobat/readstep2.html">

<% elsif @thing.image_urls.length > 0 %>

    <% url = @thing.image_urls(2000, 2000).first %>
    <%= link_to url do %>
      <%= image_tag url, style: 'width: 100%;' %>
    <% end %>

  <% @thing.image_service_urls.drop(1).each do |image_service_url| %>
    <%= link_to "#{image_service_url}/full/!1600,1600/0/default.jpg" do %>
      <%= image_tag "#{image_service_url}/full/!200,200/0/default.jpg", style: 'width: auto;' %>
    <% end %>
  <% end %>

<% else %>

  <p class="big">This thing hasnâ€™t been digitized (yet), we think.</p>

<% end %>

<hr />
<div class="row">
	<div class="four columns">
		<h5>Subjects</h5>
	<% if @subjects.length > 0 %>
		<p>
		<%= @subjects.collect do |subject| %>
		  <% link_to subject.label, subject %>
		<% end.to_sentence.html_safe %>
		</p>
	<% else %>
		<p>None, yet.</p>	
	<% end %>	
	
		<h5>Links</h5>
		<ul>
			<li><a href="http://wellcomelibrary.org/item/<%= @thing.identifier %>">View on Wellcome Library</a></li>
			<li><a href="http://search.wellcomelibrary.org/iii/encore/record/C__R<%= @thing.identifier[0..-2] %>">Full catalogue record</a></li>
			<li><%= link_to "JSON data", thing_path(format: :json) %></li>
		</ul>
	</div>
	
	<div class="offset-by-one seven columns">

      <!-- MaRC 520 -->
      <h4>Summary</h4>
<% if @thing.summary %>
        <p><%= @thing.summary.html_safe %></p>
<% else %>
		<p>None that we have found. (That doesn't mean there isn't one.)</p>
<% end %>
	
      <!-- MaRC 545 -->
      <h4>About</h4>
<% if @thing.about %>
        <p><%= @thing.about.html_safe %></p>
<% else %>
		<p>We didn't find a description of this. (That doesn't mean there isn't one.)</p>
<% end %>	

	<ul>
<% if @thing.year || @thing.publishers %>
	  <li>Published
		<% if @thing.year %>in <%= @thing.year %><% end %>
		<% if @thing.publishers %>by <%= @thing.publishers.to_sentence %><% end %>
	  </li>
<% end %>

<% if @thing.collection %>
	  <li>Part of the <%= content_tag 'span', "#{@thing.collection} collection", class: @thing.collection.downcase %></li>
<% end %>
	</ul>
	</div>
</div>
